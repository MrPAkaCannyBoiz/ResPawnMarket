@page "/resellercheck"
@using ApiContracts.Dtos
@inject BlazorApp.Services.IProductInspectionHttpService InspectionService

<h3>Pending Products</h3>

@if (loading)
{
    <p>Loading...</p>
}
else
{
    @foreach (var p in products)
    {
        <div class="card p-3 mb-3">
            <h5>@p.Name</h5>
            <p>@p.Description</p>
            <p>Price: @p.Price</p>

            <input class="form-control mb-2" placeholder="Comment (required if rejecting)" @bind="comment" />

            @* <button class="btn btn-success me-2" @onclick="() => Review(p.Id, "APPROVED")">Approve</button>
            <button class="btn btn-danger" @onclick="() => Review(p.Id, "REJECTED")">Reject</button> *@
        </div>
    }
}

@code {
    private List<ProductDto> products = new();
    private bool loading = true;
    private string? comment;

    // protected override async Task OnInitializedAsync()
    // {
    //     products = (await InspectionService.GetPendingProductsAsync()).ToList();
    //     loading = false;
    // }

    private async Task Review(int productId, string status)
    {
        // if (status == "REJECTED" && string.IsNullOrWhiteSpace(comment))
        // {
        //     await JS.InvokeVoidAsync("alert", "Please write a reason for the denial of purchase");
        //     return;
        // }

        // await InspectionService.ReviewProductAsync(
        //     new ProductInspectionRequestDto(productId, 1, status, comment)
        // );

        // products = (await InspectionService.GetPendingProductsAsync()).ToList();
        // comment = "";
    }
}
